.. _per_smart_fan:

2.12 Intelligenter Ventilator
=============================

In diesem Projekt erstellen wir einen temperaturgesteuerten intelligenten Ventilator mit Thermistor, TA6586, Motor und Spannungsmodul. Der Ventilator dreht sich automatisch, sobald die eingestellte Temperatur erreicht ist.

Für dieses Projekt benötigen wir die folgenden Komponenten.

Es ist definitiv praktisch, ein komplettes Set zu kaufen. Hier ist der Link:

.. list-table::
    :widths: 20 20 20
    :header-rows: 1

    *   - Name	
        - ARTIKEL IN DIESEM SET
        - LINK
    *   - Kepler Kit	
        - 450+
        - |link_kepler_kit|

Sie können die Komponenten auch einzeln über die untenstehenden Links erwerben.

.. list-table::
    :widths: 5 20 5 20
    :header-rows: 1

    *   - SN
        - KOMPONENTE	
        - ANZAHL
        - LINK

    *   - 1
        - :ref:`cpn_pico_w`
        - 1
        - |link_picow_buy|
    *   - 2
        - Micro-USB-Kabel
        - 1
        - 
    *   - 3
        - :ref:`cpn_breadboard`
        - 1
        - |link_breadboard_buy|
    *   - 4
        - :ref:`cpn_wire`
        - Mehrere
        - |link_wires_buy|
    *   - 5
        - :ref:`cpn_ta6586`
        - 1
        - 
    *   - 6
        - :ref:`cpn_motor`
        - 1
        - |link_motor_buy| 
    *   - 7
        - :ref:`cpn_lipo_charger`
        - 1
        -  
    *   - 8
        - 18650 Batterie
        - 1
        -  
    *   - 9
        - Batteriehalter
        - 1
        - 
    *   - 10
        - :ref:`cpn_resistor`
        - 1(10KΩ)
        - |link_resistor_buy|
    *   - 11
        - :ref:`cpn_photoresistor`
        - 1
        - |link_photoresistor_buy|

**Verkabelung**

|temperature_controlled_fan0|

**Code**

.. note::

    * Sie können sich an der Abbildung unten orientieren, um den Code per Drag-and-Drop zu schreiben. 
    * Importieren Sie ``2.12_smart_fan.png.png`` aus dem Verzeichnis ``kepler-kit-main\piper``. Detaillierte Anleitungen finden Sie unter :ref:`import_code_piper`.

    |temperature_controlled_fan|

* Nach dem Anschluss des Pico W klicken Sie auf die **Start**-Taste, und der Code wird ausgeführt.
* Klicken Sie auf CONSLE, um die aktuelle Temperatur in Grad Celsius zu sehen.
* Der Ventilator beginnt sich zu drehen, wenn die Temperatur über 25 Grad steigt, und stoppt, wenn sie unter 25 Grad fällt.

.. note::

    * Wenn der Motor sich nach dem Klicken auf die Stopptaste weiter dreht, müssen Sie den Run-Pin am Pico W zu diesem Zeitpunkt mit einem Draht auf GND zurücksetzen und dann den Draht wieder abziehen, um den Code erneut auszuführen.
    * Dies liegt daran, dass der Motor mit zu hohem Strom arbeitet, was dazu führen kann, dass der Pico W die Verbindung zum Computer verliert.

    |wiring_run_reset|

**Funktionsweise**

|temperature_controlled_fan1|

Die Spannung von A0 (GP26) wird gelesen und der Variablen [Vr] zugewiesen.

|temperature_controlled_fan2|

Diese Berechnungen wandeln die Werte des Thermistors in Grad Celsius um.

.. note::
    Hier ist die Beziehung zwischen dem Widerstand und der Temperatur:

    **RT = RN expB(1/TK – 1/TN)**

    * RT ist der Widerstand des NTC-Thermistors bei der Temperatur TK.
    * RN ist der Widerstand des NTC-Thermistors bei der Nenntemperatur TN. Hier beträgt der numerische Wert von RN 10k.
    * TK ist eine Kelvin-Temperatur und die Einheit ist K. Hier beträgt der numerische Wert von TK 273,15 + Grad Celsius.
    * TN ist eine Nenntemperatur in Kelvin; die Einheit ist ebenfalls K. Hier beträgt der numerische Wert von TN 273,15 + 25.
    * Und B (Beta), die Materialkonstante des NTC-Thermistors, wird auch als Wärmeempfindlichkeitsindex bezeichnet und hat den numerischen Wert 3950.
    * exp steht für Exponentialfunktion, und die Basiszahl e ist eine natürliche Zahl und beträgt ungefähr 2,7.

    Verwenden Sie diese Formel **TK=1/(ln(RT/RN)/B+1/TN)**, um die Kelvin-Temperatur zu erhalten, von der 273,15 abgezogen Grad Celsius entspricht.

    Diese Beziehung ist eine empirische Formel. Sie ist nur dann genau, wenn die Temperatur und der Widerstand im effektiven Bereich liegen.

|temperature_controlled_fan5|

Wenn die Temperatur höher als 25 Grad Celsius ist, setzen Sie GP14 auf EIN und GP15 auf AUS, um den Motor rotieren zu lassen. Alternativ können Sie deren Zustände auch umkehren. Wenn die Temperatur niedriger als 25 Grad Celsius ist, setzen Sie sowohl GP14 als auch GP15 auf NIEDRIG, um den Motor anzuhalten.
