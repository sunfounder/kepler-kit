.. note::

    こんにちは、SunFounderのRaspberry Pi & Arduino & ESP32愛好家コミュニティへようこそ！Facebook上でRaspberry Pi、Arduino、ESP32についてもっと深く掘り下げ、他の愛好家と交流しましょう。

    **参加する理由は？**

    - **エキスパートサポート**：コミュニティやチームの助けを借りて、販売後の問題や技術的な課題を解決します。
    - **学び＆共有**：ヒントやチュートリアルを交換してスキルを向上させましょう。
    - **独占的なプレビュー**：新製品の発表や先行プレビューに早期アクセスしましょう。
    - **特別割引**：最新製品の独占割引をお楽しみください。
    - **祭りのプロモーションとギフト**：ギフトや祝日のプロモーションに参加しましょう。

    👉 私たちと一緒に探索し、創造する準備はできていますか？[|link_sf_facebook|]をクリックして今すぐ参加しましょう！

.. _ar_pir:

2.10 - 人の動きを検出する
=========================================

受動型赤外線センサー（PIRセンサー）は、視野内の物体が放出する赤外線（IR）を測定できる一般的なセンサーです。
簡単に言えば、人体や他の動物から放出される赤外線を受け取り、それによって人々や他の動物の動きを検出します。
具体的には、誰かがあなたの部屋に入ったことをメインコントロールボードに通知します。

:ref:`cpn_pir`

**必要なコンポーネント**

このプロジェクトに必要なコンポーネントは以下の通りです。

一式をまとめて購入すると便利です、そのためのリンクはこちら：

.. list-table::
    :widths: 20 20 20
    :header-rows: 1

    *   - 名前
        - このキットに含まれるアイテム
        - 購入リンク
    *   - ケプラーキット
        - 450+
        - |link_kepler_kit|

以下のリンクから個別にも購入できます。

.. list-table::
    :widths: 5 20 5 20
    :header-rows: 1

    *   - SN
        - コンポーネント紹介
        - 数量
        - 購入リンク
    *   - 1
        - :ref:`cpn_pico_w`
        - 1
        - |link_picow_buy|
    *   - 2
        - マイクロUSBケーブル
        - 1
        - 
    *   - 3
        - :ref:`cpn_breadboard`
        - 1
        - |link_breadboard_buy|
    *   - 4
        - :ref:`cpn_wire`
        - 数本
        - |link_wires_buy|
    *   - 5
        - :ref:`cpn_pir`
        - 1
        - |link_pir_buy|

**回路図**

|sch_pir|

PIRモジュールが誰かが通り過ぎるのを検出すると、GP14は高くなります。そうでなければ低いままです。

**配線**

|wiring_pir|

**コード**

.. note::

   * ファイル ``2.10_detect_human_movement.ino`` は、 ``kepler-kit-main/arduino/2.10_detect_human_movement`` のパスで開くことができます。
   * または、このコードを **Arduino IDE** にコピーしてください。
   
   * **アップロード** ボタンをクリックする前に、ボード（Raspberry Pi Pico）と正しいポートを選択してください。

.. raw:: html
    
    <iframe src=https://create.arduino.cc/editor/sunfounder01/bb3ff9f1-127d-4279-84b9-cba28b9667e8/preview?embed style="height:510px;width:100%;margin:10px 0" frameborder=0></iframe>

プログラムが実行された後、PIRモジュールが近くに誰かいることを検出すると、シリアルモニターに「Somebody here!」と表示されます。

**詳しく知る**

PIRは非常に敏感なセンサーです。使用環境に適応させるためには、調整が必要です。
2つのポテンショメータがある側を自分に向けて、両方のポテンショメータを反時計回りに最後まで回し、Lと中央のピンにジャンパーキャップを挿入します。

|img_pir_back|

1. トリガーモード

   まずは、角にジャンパーキャップがあるピンを見てみましょう。
   これによって、PIRは繰り返し可能なトリガーモードまたは非繰り返し可能なトリガーモードに入ることができます。
   
   現在、ジャンパーキャップは中央のピンとLピンを接続しており、PIRは非繰り返し可能なトリガーモードになっています。
   このモードでは、PIRが生物の動きを検出すると、約2.8秒間、メインコントロールボードに高レベルの信号を送ります。
   .. 印刷されたデータで見ると、作動時間は常に2800ms前後です。
   
   次に、下のジャンパーキャップの位置を変更し、中央のピンとHピンを接続して、PIRを繰り返し可能なトリガーモードにします。
   このモードでは、PIRが生物の動きを検出する（センサーの前で静止しているのではなく、動いていることに注意）と、生物が検出範囲内で動き続ける限り、PIRは高レベルの信号をメインコントロールボードに続けて送ります。
   .. 印刷されたデータで見ると、作動時間は不確定な値です。

#. 遅延調整

   左側のポテンショメータは、二つのジョブの間隔を調整するために使用されます。

   現在、それを反時計回りに最後まで回していますが、これによってPIRは高レベル作動が終了した後、約5秒間スリープ状態に入る必要があります。
   この期間中、PIRは対象エリアの赤外線放射を検出しません。
   .. 印刷されたデータで見ると、休眠期間は常に5000ms以上です。

   ポテンショメータを時計回りに回すと、スリープ時間も増加します。
   時計回りに最後まで回すと、スリープ時間は最大300sになります。

#. 距離調整

   中央のポテンショメータは、PIRの感知距離範囲を調整するために使用されます。

   距離調整のポテンショメータのつまみを **時計回り** に回すと、感知距離範囲が増加し、最大感知距離範囲は約0-7メートルです。
   **反時計回り** に回すと、感知距離範囲が減少し、最小感知距離範囲は約0-3メートルです。

